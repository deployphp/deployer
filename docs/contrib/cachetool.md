<!-- DO NOT EDIT THIS FILE! -->
<!-- Instead edit contrib/cachetool.php -->
<!-- Then run bin/docgen -->

# Cachetool Recipe

```php
require 'contrib/cachetool.php';
```

[Source](/contrib/cachetool.php)




## Configuration

- **cachetool:socket:tcp** *(optional)*: accepts a *string* with IP address and port to the php-fpm TCP socket

    ```php
    set('cachetool:socket:tcp', '127.0.0.1:9000');
    ```

- **cachetool:socket:glob** *(optional)*: accepts a path or glob pattern to the php-fpm unix socket(s)

    ```php
    set('cachetool:socket:glob', '/var/run/php-*.sock');
    ```
    
Another alternative for multiple sockets is to specify them directly as array:

```php
set('cachetool:sockets', [
    '/var/run/php-domain-a.sock',
    '/var/run/php-domain-b.sock',
]);
```

This will override any `cachetool:socket:tcp` or `cachetool:socket:glob` configuration.

If neither of the above configuration values is given, then the tool will look for a `cachetool.yml` file in the current or any parent directory and read the configuration from there. See [cachetool documentation](https://github.com/gordalina/cachetool#configuration-file)

You can also specify different cachetool settings for each host:
```php
host('staging')
    ->set('cachetool:socket:tcp', '127.0.0.1:9000');

host('production')
    ->set('cachetool:socket:glob', '/var/run/php-fpm.sock');
```

If your deployment user does not have permission to access the socket, you can alternatively use
the web adapter that creates a temporary php file and makes a web request to it with a configuration like
```php
set('cachetool_args', '--web --web-path=./public --web-url=https://{{hostname}}');
```

In this case, do not set `cachetool:socket:tcp` or `cachetool:socket:glob`.

## Usage

Since APCu and OPcache deal with compiling and caching files, they should be executed right after the symlink is created for the new release:

```php
after('deploy:symlink', 'cachetool:clear:opcache');
or
after('deploy:symlink', 'cachetool:clear:apcu');
```

## Read more

Read more information about cachetool on the website:
http://gordalina.github.io/cachetool/


## Configuration
### cachetool:socket:tcp
[Source](https://github.com/deployphp/deployer/blob/master/contrib/cachetool.php#L65)





### cachetool:socket:glob
[Source](https://github.com/deployphp/deployer/blob/master/contrib/cachetool.php#L66)





### cachetool:sockets
[Source](https://github.com/deployphp/deployer/blob/master/contrib/cachetool.php#L72)

Array of sockets (TCP or Unix socket)

If not set explicitly, they are determined by `cachetool:socket:tcp` or `cachetool:socket:glob`.
:::info Autogenerated
The value of this configuration is autogenerated on access.
:::




### cachetool_url
[Source](https://github.com/deployphp/deployer/blob/master/contrib/cachetool.php#L94)

URL to download cachetool from if it is not available

CacheTool 8.x works with PHP >=8.0
CacheTool 7.x works with PHP >=7.3

```php title="Default value"
'https://github.com/gordalina/cachetool/releases/download/7.0.0/cachetool.phar'
```


### cachetool_args
[Source](https://github.com/deployphp/deployer/blob/master/contrib/cachetool.php#L95)





### bin/cachetool
[Source](https://github.com/deployphp/deployer/blob/master/contrib/cachetool.php#L101)

Path to the executable cachetool binary (cachetool.phar)

If not set explicitly, it will look in the current/release path and if not present, download it from `cachetool_url` to .dep/cachetool.phar.
:::info Autogenerated
The value of this configuration is autogenerated on access.
:::





## Tasks

### cachetool:clear:opcache
[Source](https://github.com/deployphp/deployer/blob/master/contrib/cachetool.php#L120)

Clears OPcode cache.

Clear opcache cache


### cachetool:clear:apcu
[Source](https://github.com/deployphp/deployer/blob/master/contrib/cachetool.php#L158)

Clears APCu system cache.

Clear APCU cache


### cachetool:clear:stat
[Source](https://github.com/deployphp/deployer/blob/master/contrib/cachetool.php#L173)

Clears file status and realpath caches.

Clear file status cache, including the realpath cache


